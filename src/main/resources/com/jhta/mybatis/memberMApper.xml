<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jhta.mybatis.memberMApper">
	
	<insert id="insertM" parameterType="member">
		insert into memberlist values(#{m_email},#{m_pwd},#{m_name},#{m_phone},#{m_addr},0,sysdate,#{m_gubun},null,null)
	</insert>
	
	
	<insert id="insertP" parameterType="petsitter">
		insert into petsitter(PS_EMAIL,PS_PWD,PS_PHONE,PS_NAME,PS_ADDR1,PS_ADDR2,PS_CONTENT,PS_REGDATE,PS_LAT,
PS_LNG,PS_SAVEIMAGE,PS_ORIGINALIMG,PS_GUBUN,PS_GRADE) values(#{ps_email},#{ps_pwd},#{ps_phone},#{ps_name},#{ps_addr1},#{ps_addr2}
		,#{ps_content},sysdate,#{ps_lat},#{ps_lng},null,null,#{ps_gubun},0,0)
	</insert>
	
	
	<select id="emailc" parameterType="string" resultType="int">
		select COUNT(*) from  memberlist m , petsitter p where m.m_email = #{value} or p.ps_email = #{value}
	</select>
	
	<select id="emailc_m" parameterType="string" resultType="int">
		select count(*) from memberlist where m_email = #{value}	
	</select>
	
	
	<select id="emailc_p" parameterType="string" resultType="int">
		select count(*) from petsitter where ps_email = #{value}	
	</select>
	
	
	
	<select id="pwd" parameterType="map" resultType="string">
		select 
		<if test="gubun eq 'member'">
			m_pwd from memberlist where m_email = #{email}
		</if>
		<if test="gubun eq 'petsitter'">
			ps_pwd from petsitter where ps_email = #{email}
		</if>
	</select>
	
	<select id="pwd_search" parameterType="map" resultType="int">
		select count(*) from
		<if test="gubun eq 'member'">
			memberlist where m_email = #{email} and m_name = #{name} and m_phone = #{phone}
		</if>
		<if test="gubun eq 'petsitter'">
			petsitter where ps_email = #{email} and ps_name = #{name} and ps_phone = #{phone}
		</if>
	</select>
	
	
	<update id="pwd_ok" parameterType="map" >
		<if test="gubun eq 'member'">
		update memberlist set m_pwd = #{pwd} where m_email = #{email}
		</if>
		<if test="gubun eq 'petsitter'">
		update petsitter set ps_pwd  = #{pwd} where ps_email = #{email}
		</if>
	</update>
	
	
	
	
	<select id="selectMember" parameterType="string" resultType="member">
	
		select * from memberlist where m_email=#{value}	
	</select>
	
	<update id="updateMember" parameterType="member">
		update memberlist set m_name=#{m_name},m_phone=#{m_phone},m_addr=#{m_addr} where m_email=#{m_email}	
	</update>
	
	<update id="updatePwd" parameterType="member">
		update memberlist set m_pwd=#{m_pwd} where m_email=#{m_email}	
	</update>
	
	<select id="infoEmail" parameterType="string" resultType="member">
		select * from memberlist where m_email=#{value}
	</select>
	
	<delete id="deleteMember" parameterType="string">
		delete from memberlist where m_email=#{value}
	</delete>
	
	<update id="uploadImg" parameterType="hashmap">
		update memberlist set m_saveimage=#{m_saveimage},m_originalimg=#{m_originalimg} where m_email=#{m_email}
	</update>
</mapper>

